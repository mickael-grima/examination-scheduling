%!TEX program = xelatex
\documentclass[12pt,t]{beamer}

\usetheme[
progressbar=frametitle,
%titleformat=regular
%sectionpage=progressbar,
%noframetitleoffset,
%block=fill
]{m}
\definecolor{TUMblue}{RGB}{55,55,255}
\setbeamercolor{alerted text}{fg=TUMblue}

\metroset{inner/titleformat=regular}
\metroset{inner/sectiontitleformat=uppercase}
\metroset{outer/frametitleformat=regular}

% \usepackage{booktabs}
% \usepackage[scale=2]{ccicons}

%  \usetheme{Rochester}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
%\usepackage[german]{babel}
\usepackage{indentfirst} % \and
\usepackage{hyperref}
\usepackage{multirow}

\usepackage{amsmath}
%\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{dsfont}
\usepackage{natbib}

\usepackage{graphicx}
\usepackage{tikz}
\usepackage{calc}
%\usepackage{ifthen}

\newcommand{\R}{\mathds{R}}     
\newcommand{\N}{\mathds{N}}
\newcommand{\sU}{\mathcal{U}}

\usetikzlibrary{arrows}

%\usepackage{algorithm2e}
%\usepackage{algorithmic}

%% Custom commands
\newcommand{\hide}[1]{}
%\newcommand{\definition}[1]{\textbf{Definition: #1}}
%\newcommand{\algorithm}[1]{\textbf{Algorithm: #1}}
\def\ba#1\ea{\begin{align*}#1\end{align*}}
\def\ban#1\ean{\begin{align}#1\end{align}}
\newenvironment{abschnitt}{}{}

\author{Alexander Eckl, Maximilian Fiedler, Mickael Grima, \protect\\Roland Halbig}
\title{Examination Scheduling}
%\subtitle{subtitle}
%\logo{}
\institute{Technische Universität München}
\date{May 25, 2016}
%\subject{}
%\setbeamercovered{transparent}
\setbeamertemplate{navigation symbols}{}


\begin{document}
        
\maketitle

\begin{frame}{Outline}
      	\tableofcontents
\end{frame}

\section{Problem Formulation}

\begin{frame}[c]{Problem} 
       Find a good examination schedule for the exam period of the TUM.
\end{frame}

\begin{frame}{Criteria for a good examination schedule}    	
 	\begin{itemize}
		\item Each exam is planned in exactly one period
		\item<2-> In each room there is only one exam at a time
		\item<3-> There are enough seats for each exam
		\item<4-> No student has to write two exams at the same time
		\item<5-> Rooms for an exam are minimized
		\item<6-> Time between exams is maximized
 	\end{itemize}	
\end{frame}

\section{Modeling The Problem}

\begin{frame}{Variables}
      	\ba
   		x_{i,k,l} &:= \left\{ \begin{array}{cl} 1, & \mbox{if exam $i$ is written in period $l$ in room $k$ } \\ 
   		0, & \mbox{otherwise} \end{array} \right.  \\
		\uncover<2->{
   		y_{i,l} &:= \left\{ \begin{array}{cl} 1, & \mbox{if exam $i$ is written in period $l$} \\ 
   		0, & \mbox{otherwise} \end{array} \right.
   		}
      	\ea
\end{frame}

\begin{frame}{Constraints}
  	\begin{itemize} 
	    \item Connecting the variables $x$ and $y$:
	    \pause
	    \ba
	   	(1) & \sum_{\mbox{\scriptsize{ rooms $k$}}} x_{i,k,l} &&\leq y_{i,l} \cdot M &&\forall \mbox{\small{ exams $i$, }}  \forall \mbox{\small{ periods $l$}}  \\[4mm]
	    \uncover<3->{
	    (2) & \sum_{\mbox{\scriptsize{ rooms $k$}}} x_{i,k,l} &&\geq y_{i,l} &&\forall \mbox{\small{ exams $i$, }}  \forall \mbox{\small{ periods $l$}}
	    }
   		\ea
   	\end{itemize}
\end{frame}

\begin{frame}{Constraints}
	\begin{itemize}                     
  		\item Each exam is planned in exactly one period:
  		\pause
		\ba
		(3) & \sum_{\mbox{\scriptsize{ periods $l$}}} y_{i,l} &&= 1 &&\forall \mbox{ exams $i$ } \\[4mm]
		\uncover<3->{
		\text{c.f. }(2) & \sum_{\mbox{\scriptsize{ rooms $k$}}} x_{i,k,l}  &&\geq y_{i,l} &&\forall \mbox{ exams $i$, } \forall \mbox{\small{ periods $l$}}
		}
		\ea
 	\end{itemize}
\end{frame}

\begin{frame}{Constraints}
    \begin{itemize} 
        \item There are enough seats for the students in the exam rooms:
        \pause
        \ba
        (4) & \sum_{\substack{\mbox{\scriptsize{ periods $l$, }} \\ \mbox{\scriptsize{ rooms $k$ }}}} c_k \cdot x_{i,k,l} &&\geq s_i &&\forall \mbox{\small{ exams $i$}}
        \ea
        
        \ba
        s_i &:= \text{ \# students taking exam $i$} \\
        c_k &:= \text{ \# seats in room $k$} \\
        \ea
    \end{itemize}
\end{frame}

\begin{frame}{Constraints}
    \begin{itemize}    
        \item In every room there is only one exam at a given time:
        \pause
        \ba
        (5) & \sum_{\mbox{\scriptsize{ exams $i$ }}} x_{i,k,l} &&\leq 1 &&\forall \mbox{\small{ rooms $k$}}, \forall \mbox{\small{ periods $l$ }}
        \ea
    \end{itemize}
\end{frame}

\begin{frame}{Constraints}
    \begin{itemize}
        \item There are no conflicts for students taking multiple exams:
        \pause
        \ba
        (6) & \sum_{\substack{\mbox{\scriptsize{ exams $j$,}} \\  \mbox{\scriptsize{$j$ conflicts with $i$}} }}y_{j,l} &&\leq (1-y_{i,l}) \cdot M &&\forall \mbox{\footnotesize{ exams $i$, }} \forall \mbox{\footnotesize{ periods $l$ }}
        \ea
    \end{itemize}
\end{frame}

%\section{Objective Function}
        
\begin{frame}{Objective function}
	\begin{itemize}
        \item Minimize the total number of rooms:
        \ba
        \min & \sum_{\substack{\mbox{\scriptsize{ exams $i$,}} \\ \mbox{\scriptsize{ rooms $k$,}} \\ \mbox{\scriptsize{ periods $l$}}}} x_{i,k,l} 
        \ea
	\end{itemize}
\end{frame}
        
\begin{frame}{Objective function}
	\begin{itemize}
		\item Maximize the time between two exams:
		\ba
		\max \sum_{\substack{\mbox{\scriptsize{ exams $i,j$}} \\ \mbox{\scriptsize{$i$ conflicts with $j$}} }}   d_{i,j}
		\ea
		
		\ba
		d_{i,j} &:= \text{distance between exams i and j}
		\ea
	\end{itemize}
\end{frame}

\begin{frame}{Objective function}
    \begin{itemize}	
    	\item Combine the previous two objective functions using a weighting factor $\gamma > 0$:
	    \ba
	    \min \sum_{\substack{\mbox{\scriptsize{ exams $i$,}} \\ \mbox{\scriptsize{ rooms $k$,}} \\ \mbox{\scriptsize{ periods $l$}}}} x_{i,k,l} \ - \ \gamma \cdot \sum_{\substack{\mbox{\scriptsize{ exams $i,j$}} \\ \mbox{\scriptsize{$i$ conflicts with $j$}} }}   d_{i,j}
	    \ea
	\end{itemize}
\end{frame}
        
\section{Next Steps}

\begin{frame}{Finding a feasible starting point}
    \begin{itemize}
        \item Use graph-coloring to schedule exams without conflicts.
        \pause
        \item Plan difficult exams first.
        \pause
        \item Calculate difficulty by:
        \pause
        \begin{itemize}
        	\item Number of students taking exam
        	\pause
        	\item Identifying cliques in conflict graph	
        \end{itemize}
    \end{itemize}
\end{frame}

\begin{frame}{Improvements to the model}
	\begin{itemize}
	    \item Add Clique Constraints:
	    \ba
	    (7) &\sum_{\mbox{\scriptsize{$i$ in clique}}} y_{i,l} &&\leq 1 &&\forall \, \mbox{\small{cliques calculated from the conflict graph}}
	    \ea
	    \pause
	    \item Remove absolute value in the objective function.
	    \pause
	    \item Improve running time using heuristics, pre-solving, etc.	    
    \end{itemize}
\end{frame}

\begin{frame}{Data acquisition}
	\begin{itemize}
		\item -dummy-
	    \item -From exam coordinator for Mathematics-
	    \item -From central exam coordinator-
	    \item -Direct export from TUMonline-   
    \end{itemize}
\end{frame}
     
\end{document}